require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/user_payment/index"],{"048e":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("99c8"),a=n("d5f7"),r=n("79c7"),o=n("26cb"),c=s(n("a29e")),u=n("aed8");function s(e){return e&&e.__esModule?e:{default:e}}var f=function(){n.e("components/payment/index").then(function(){return resolve(n("fb96"))}.bind(null,n)).catch(n.oe)},l=function(){Promise.all([n.e("common/vendor"),n.e("components/home/index")]).then(function(){return resolve(n("d878"))}.bind(null,n)).catch(n.oe)},h={components:{home:l,payment:f},mixins:[c.default],data:function(){return{now_money:0,navRecharge:["账户充值","佣金转入"],active:0,number:"",userinfo:{},placeholder:"0.00",from:"",isAuto:!1,isShowAuth:!1,picList:[],activePic:0,money:"",numberPic:"",rechar_id:0,password:"",goodsList:[],pay_order_id:"",payMode:[{name:"微信支付",icon:"icon-weixinzhifu",value:"weixin",title:"微信快捷支付",payStatus:!0}],pay_close:!1,payType:"",totalPrice:"0",formContent:"",type:"",rechargeAttention:[],moneyMaxLeng:8}},computed:(0,o.mapGetters)(["isLogin"]),watch:{isLogin:{handler:function(e,t){e&&(this.getUserInfo(),this.getRecharge())},deep:!0}},onLoad:function(e){this.isLogin?(this.getOrderPayType(),this.getUserInfo(),this.getRecharge()):(0,a.toLogin)()},onShow:function(){e.removeStorageSync("form_type_cart")},methods:{onLunch:function(){this.getOrderPayType(),this.getUserInfo(),this.getRecharge()},inputNum:function(e){var t=e.detail.value,n=t.indexOf(".");this.moneyMaxLeng=n>-1?n+3:8},picCharge:function(e,t){this.activePic=e,void 0===t?(this.rechar_id=0,this.numberPic=""):(this.money="",this.rechar_id=t.id,this.numberPic=t.price)},getRecharge:function(){var e=this;(0,i.getRechargeApi)().then((function(t){e.picList=t.data.recharge_quota,e.picList[0]&&(e.rechar_id=e.picList[0].id,e.numberPic=e.picList[0].price),e.rechargeAttention=t.data.recharge_attention||[]})).catch((function(t){e.$util.Tips({title:t})}))},getOrderPayType:function(){var t=this;(0,r.orderOfflinePayType)().then((function(e){var n=e.data,i=(n.ali_pay_status,n.pay_weixin_open);t.payMode[0].payStatus=!!i})).catch((function(t){e.showToast({title:t,icon:"none"})}))},onLoadFun:function(){this.getUserInfo(),this.getRecharge()},authColse:function(e){this.isShowAuth=e},navRecharges:function(e){this.active=e},getUserInfo:function(){var e=this;(0,i.getUserInfo)().then((function(t){e.$set(e,"userinfo",t.data)}))},changePayType:function(e){this.payType="alipay"==e?"alipay":"weixinh5"},onChangeFun:function(e){var t=e,n=t.action||null,i=void 0!=t.value?t.value:null;n&&this[n]&&this[n](i)},payClose:function(){this.pay_close=!1},payCheck:function(e){this.createMemberCard(e)},createMemberCard:function(t){var n=this;e.showLoading({title:"正在加载…"}),(0,u.openPaySubscribe)().then((function(){e.showLoading({title:"正在支付"});var t=n,a=parseFloat(n.money);if(0==n.rechar_id){if(Number.isNaN(a))return t.$util.Tips({title:"充值金额必须为数字"});if(a<=0)return t.$util.Tips({title:"充值金额不能为0"})}(0,i.rechargeRoutine)({price:parseFloat(n.totalPrice),type:0,rechar_id:n.rechar_id}).then((function(n){e.hideLoading();var i=n.data,a="";a=e.requestOrderPayment?"requestOrderPayment":"requestPayment",e[a]({timeStamp:i.timestamp,nonceStr:i.nonceStr,package:i.package,signType:i.signType,paySign:i.paySign,success:function(e){return t.$set(t,"userinfo.now_money",t.$util.$h.Add(value,t.userinfo.now_money)),t.$util.Tips({title:"支付成功",icon:"success"},{tab:5,url:"/pages/users/user_money/index"})},fail:function(){return t.$util.Tips({title:"支付失败"})},complete:function(e){if("requestPayment:cancel"==e.errMsg)return t.$util.Tips({title:"取消支付"})}})})).catch((function(n){return e.hideLoading(),t.$util.Tips({title:n})}))}))},submitSub:function(t){var n=this,a=t.detail.value.number;if(n.active){if(parseFloat(a)<0||NaN==parseFloat(a)||void 0==a||""==a)return n.$util.Tips({title:"请输入金额"});e.showModal({title:"转入余额",content:"转入余额后无法再次转出，确认是否转入余额",success:function(e){if(e.confirm)(0,i.rechargeRoutine)({price:parseFloat(a),type:1}).then((function(e){return n.$util.Tips({title:"转入成功",icon:"success"},{tab:5,url:"/pages/users/user_money/index"})})).catch((function(e){return n.$util.Tips({title:e})}));else if(e.cancel)return n.$util.Tips({title:"已取消"})}})}else this.pay_close=!0,this.totalPrice=0==this.rechar_id?this.money:this.numberPic}}};t.default=h}).call(this,n("543d")["default"])},"659f":function(e,t,n){"use strict";n.r(t);var i=n("d05d"),a=n("af20");for(var r in a)"default"!==r&&function(e){n.d(t,e,(function(){return a[e]}))}(r);n("cf7c");var o,c=n("f0c5"),u=Object(c["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],o);t["default"]=u.exports},"78af":function(e,t,n){},a1c1:function(e,t,n){"use strict";(function(e){n("8824");i(n("66fd"));var t=i(n("659f"));function i(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},af20:function(e,t,n){"use strict";n.r(t);var i=n("048e"),a=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=a.a},cf7c:function(e,t,n){"use strict";var i=n("78af"),a=n.n(i);a.a},d05d:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var a=function(){var e=this,t=e.$createElement;e._self._c},r=[]}},[["a1c1","common/runtime","common/vendor"]]]);